const _fsrp = require("fs-readfile-promise");
import WaitForPromise from "infrastructure/WaitForPromise";

export function MakeAttachmentService(fsrp?: any, wait?: any) {
    return new AttachmentService(fsrp || _fsrp, wait || WaitForPromise);
}


export class AttachmentService {
    private fsrp: any;
    private wait: any;

    constructor(fsrp: any, wait: any) {
        this.fsrp = fsrp;
        this.wait = wait;
    }

    public createAttachment(filePath: string, filename: string): Attachment {
        const content = this.wait(this.fsrp(filePath));
        return { filename, content };
    }
}

export interface Attachment {
    filename: string;
    content: any;
}
