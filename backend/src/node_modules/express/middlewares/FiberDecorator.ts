/**
 * Created by kevin on 5/23/15.
 */
const waitImpl = require("wait.for");
import {ExpressMiddleware} from "express/middlewares/ExpressMiddleware";

export default class FiberDecorator implements ExpressMiddleware {

    public setupFiber: any;

    constructor(wait = waitImpl) {
        this.setupFiber = (req: any, res: any, next: any) => {
            wait.launchFiber(next);
        };
    }

    public setup(listener: any) {
        listener.use(this.setupFiber);
    }
}
